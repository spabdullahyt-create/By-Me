<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro PDF Converter</title>
    <link rel="stylesheet" href="css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="js/jspdf.umd.min.js"></script>

    <style>
        /* --- Variables and Base Styles --- */
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --accent-color: #38bdf8;
            --text-color: #f8fafc;
            --secondary-text: #94a3b8;
            --border-radius: 12px;
            --image-size: 100px; /* New variable for image size */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 90%;
            max-width: 600px;
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        /* --- Header Styles --- */
        h1 {
            font-weight: 900;
            font-size: 2rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: -1px;
        }

        h1 i { color: var(--accent-color); }

        .subtitle {
            font-size: 0.85rem;
            color: var(--secondary-text);
            margin-bottom: 2rem;
            font-weight: 400;
        }

        /* --- Upload Area --- */
        .upload-area {
            border: 3px dashed #475569;
            padding: 2rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 2rem;
        }

        .upload-area:hover {
            border-color: var(--accent-color);
            background: rgba(56, 189, 248, 0.05);
        }

        input[type="file"] { display: none; }

        /* --- Input Groups --- */
        .input-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        /* --- Preview Area (Drag-and-Drop) --- */
        #preview {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 1.5rem;
            padding: 10px 0;
            border-top: 1px solid #334155;
            border-bottom: 1px solid #334155;
            margin-bottom: 2rem;
            min-height: 120px; /* Adjusted height for larger images */
            justify-content: center;
            align-items: flex-start; /* Align items to the top */
        }
        
        /* The preview item size is now larger */
        .preview-item {
            position: relative;
            width: var(--image-size);
            height: var(--image-size);
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s;
            background-color: #334155;
            border-radius: 4px;
        }

        .preview-item:hover {
             box-shadow: 0 0 0 3px var(--accent-color);
        }

        .preview-item.dragging {
            opacity: 0.7;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.7);
        }
        
        .preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
        }
        
        .image-number {
            position: absolute;
            top: -10px;
            left: -10px;
            background: var(--accent-color);
            color: #000;
            font-weight: 900;
            padding: 2px 6px;
            border-radius: 50%;
            font-size: 0.7rem;
            min-width: 15px;
            text-align: center;
            line-height: 1;
            z-index: 10;
        }

        /* Delete Button */
        .delete-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444; /* Red color for delete */
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            line-height: 20px;
            padding: 0;
            cursor: pointer;
            z-index: 15;
            transition: background 0.2s;
        }
        .delete-btn:hover { background: #dc2626; }

        /* Add More Button Style */
        .add-more-btn {
            width: var(--image-size);
            height: var(--image-size);
            border: 3px dashed #475569;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--secondary-text);
            cursor: pointer;
            transition: border-color 0.2s, color 0.2s;
        }

        .add-more-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        /* --- Button Styles --- */
        .btn {
            background: var(--accent-color);
            color: #000;
            border: none;
            padding: 1rem 2rem;
            font-weight: 900;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            text-transform: uppercase;
            transition: transform 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .btn:hover { transform: translateY(-2px); opacity: 0.9; }
        .btn:disabled { background: #475569; cursor: not-allowed; }

        /* --- Modal Styles (Unchanged) --- */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.7); 
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 15% auto;
            padding: 30px;
            border-radius: var(--border-radius);
            width: 80%;
            max-width: 300px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .success-icon {
            color: var(--accent-color);
            font-size: 3rem;
            margin-bottom: 15px;
            animation: bounceIn 0.5s ease-out;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.1); opacity: 0; }
            60% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); }
        }

        .modal-message {
            font-size: 1.2rem;
            font-weight: 700;
        }
    </style>
</head>
<body>

<div class="container">
    <h1><i class="fas fa-file-pdf"></i> Image to PDF</h1>
    <p class="subtitle">Simple And Fast Tool | FTGM HACKS Â©</p>

    <div class="upload-area" id="initialUploadArea" onclick="document.getElementById('imageInput').click()" style="display: block;">
        <i class="fas fa-cloud-upload-alt fa-3x" style="margin-bottom: 10px;"></i>
        <p><strong>Click to select images</strong></p>
        <p style="font-size: 0.8rem; color: var(--secondary-text);">PNG, JPG, JPEG supported</p>
    </div>

    <input type="file" id="imageInput" multiple="" accept="image/*" onchange="handleFiles(this.files, true)">

    <div class="input-group">
        <label for="filename"><i class="fas fa-tag"></i> Custom PDF Name</label>
        <input type="text" id="filename" placeholder="my-awesome-document" value="Converted_Images">
    </div>
    
    <label style="text-align: left;"><i class="fas fa-images"></i> Image Order (Drag to Reorder)</label>
    <div id="preview"></div>

    <button id="downloadBtn" class="btn" disabled="" onclick="generatePDF()">
        <i class="fas fa-download"></i> Download PDF
    </button>
</div>

<div id="successModal" class="modal">
    <div class="modal-content">
        <i class="fas fa-check-circle success-icon"></i>
        <p class="modal-message">PDF Downloaded Successfully!</p>
    </div>
</div>

<script>
    // Stores the File objects or Data URLs of the images
    let selectedImages = [];
    const previewContainer = document.getElementById('preview');
    const downloadBtn = document.getElementById('downloadBtn');
    const successModal = document.getElementById('successModal');
    const fileInput = document.getElementById('imageInput');
    const initialUploadArea = document.getElementById('initialUploadArea');
    
    // --- Utility Functions ---

    /**
     * Removes an image from the selectedImages array and re-renders the preview.
     * @param {number} index - The index of the image to remove.
     */
    function removeImage(index) {
        if (index >= 0 && index < selectedImages.length) {
            selectedImages.splice(index, 1);
            renderPreview();
        }
    }

    /**
     * Renders the image previews and the "Add More" button in the DOM.
     */
    function renderPreview() {
        previewContainer.innerHTML = '';
        
        // Toggle visibility of the initial upload area
        initialUploadArea.style.display = selectedImages.length === 0 ? 'block' : 'none';

        if (selectedImages.length === 0) {
            downloadBtn.disabled = true;
            return;
        }
        
        // 1. Render Image Previews
        selectedImages.forEach((dataUrl, index) => {
            const previewItem = document.createElement('div');
            previewItem.className = 'preview-item';
            previewItem.draggable = true;
            // IMPORTANT: use the index of the array for data-index
            previewItem.dataset.index = index; 

            const img = document.createElement('img');
            img.src = dataUrl;
            img.className = 'preview-img';

            const number = document.createElement('div');
            number.className = 'image-number';
            number.textContent = index + 1;

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = '<i class="fas fa-times"></i>';
            // Use an anonymous function to pass the index to removeImage
            deleteBtn.onclick = (e) => {
                e.stopPropagation(); // Prevent drag events from triggering
                removeImage(index);
            };

            previewItem.appendChild(img);
            previewItem.appendChild(number);
            previewItem.appendChild(deleteBtn);
            previewContainer.appendChild(previewItem);
        });
        
        // 2. Render Add More Button
        const addMore = document.createElement('div');
        addMore.className = 'add-more-btn';
        addMore.innerHTML = '<i class="fas fa-plus fa-lg"></i><p style="margin: 5px 0 0; font-size: 0.8rem;">Add More</p>';
        addMore.onclick = () => fileInput.click();
        
        previewContainer.appendChild(addMore);


        downloadBtn.disabled = false;
        addDragDropListeners();
    }

    // --- File Handling ---

    /**
     * Handles file selection from the input field.
     * @param {FileList} files - The files selected by the user.
     * @param {boolean} clearExisting - Whether to clear the existing list (true for initial select, false for 'Add More').
     */
    function handleFiles(files, clearExisting = false) {
        if (clearExisting) {
            selectedImages = [];
        }
        
        let filesProcessed = 0;
        const newFilesArray = Array.from(files).filter(file => file.type.startsWith('image/'));
        const totalNewFiles = newFilesArray.length;

        if (totalNewFiles === 0) {
            renderPreview(); // Rerender if files were cleared but no new ones added
            return;
        }

        for (let file of newFilesArray) {
            const reader = new FileReader();
            reader.onload = (e) => {
                selectedImages.push(e.target.result);
                filesProcessed++;
                
                // Only render once all new files are processed
                if (filesProcessed === totalNewFiles) {
                    // Reset input value so same files can be selected again
                    fileInput.value = ''; 
                    renderPreview();
                }
            };
            reader.readAsDataURL(file);
        }
    }

    // --- Drag and Drop Logic ---

    let dragSrcEl = null;

    function handleDragStart(e) {
        // Fix: Use dataTransfer for the current index
        e.dataTransfer.setData('text/plain', this.dataset.index);
        e.dataTransfer.effectAllowed = 'move';
        
        this.style.opacity = '0.4';
        this.classList.add('dragging');
        dragSrcEl = this;
    }

    function handleDragOver(e) {
        if (e.preventDefault) e.preventDefault();
        // Determine the actual drop target (the item being dragged over)
        if (this.classList.contains('preview-item')) {
            e.dataTransfer.dropEffect = 'move';
            this.classList.add('over');
        } else {
             // If dragging over the 'Add More' button or the gap, set to none/copy
             e.dataTransfer.dropEffect = 'none';
        }
        return false;
    }
    
    function handleDragEnter(e) {
        if (this.classList.contains('preview-item') && dragSrcEl !== this) {
            this.classList.add('over');
        }
    }

    function handleDragLeave(e) {
        this.classList.remove('over');
    }

    function handleDrop(e) {
        e.stopPropagation();

        if (dragSrcEl !== this && this.classList.contains('preview-item')) {
            const srcIndex = parseInt(e.dataTransfer.getData('text/plain'));
            const targetIndex = parseInt(this.dataset.index);

            // Reorder the array
            const [draggedItem] = selectedImages.splice(srcIndex, 1);
            selectedImages.splice(targetIndex, 0, draggedItem);

            renderPreview(); // Re-render to update order and numbering
        }

        this.classList.remove('over');
        dragSrcEl.classList.remove('dragging');
        dragSrcEl.style.opacity = '1';
        return false;
    }

    function handleDragEnd(e) {
        // Clean up styles on all items
        document.querySelectorAll('.preview-item').forEach(item => {
            item.style.opacity = '1';
            item.classList.remove('dragging');
            item.classList.remove('over');
        });
    }

    function addDragDropListeners() {
        document.querySelectorAll('.preview-item').forEach(item => {
            item.addEventListener('dragstart', handleDragStart);
            item.addEventListener('dragenter', handleDragEnter);
            item.addEventListener('dragover', handleDragOver);
            item.addEventListener('dragleave', handleDragLeave);
            item.addEventListener('drop', handleDrop);
            item.addEventListener('dragend', handleDragEnd);
        });
    }


    // --- PDF Generation and Success Logic (Unchanged) ---

    async function generatePDF() {
        downloadBtn.disabled = true;
        downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';

        try {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const fileName = document.getElementById('filename').value || 'document';

            for (let i = 0; i < selectedImages.length; i++) {
                if (i > 0) doc.addPage();
                
                const img = selectedImages[i];
                
                const image = new Image();
                image.src = img;
                await new Promise(resolve => image.onload = resolve);
                
                const imgWidth = image.width;
                const imgHeight = image.height;

                const pageWidth = doc.internal.pageSize.getWidth();
                const pageHeight = doc.internal.pageSize.getHeight();
                
                let scaleFactor = (pageWidth - 20) / imgWidth;

                let finalWidth = imgWidth * scaleFactor;
                let finalHeight = imgHeight * scaleFactor;
                
                if (finalHeight > pageHeight - 20) {
                    scaleFactor = (pageHeight - 20) / imgHeight;
                    finalWidth = imgWidth * scaleFactor;
                    finalHeight = imgHeight * scaleFactor;
                }

                const xPos = (pageWidth - finalWidth) / 2;
                const yPos = (pageHeight - finalHeight) / 2;

                const formatMatch = img.match(/^data:image\/(\w+);/);
                const format = formatMatch ? formatMatch[1].toUpperCase() : 'JPEG';
                
                doc.addImage(img, format, xPos, yPos, finalWidth, finalHeight); 
            }

            doc.save(`${fileName}.pdf`);
            showSuccessModal();

        } catch (error) {
            console.error("PDF generation failed:", error);
            alert("An error occurred during PDF creation: " + error.message);
        } finally {
            setTimeout(() => {
                downloadBtn.innerHTML = '<i class="fas fa-download"></i> Download PDF';
                if (selectedImages.length > 0) {
                    downloadBtn.disabled = false;
                }
            }, 500);
        }
    }

    function showSuccessModal() {
        successModal.style.display = 'flex';
        setTimeout(() => {
            successModal.style.display = 'none';
        }, 3000);
    }
    
    // Initial render to ensure UI starts correctly
    renderPreview(); 
</script>



</body></html>